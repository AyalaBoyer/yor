{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "Template Creates a single EC2 instance with a single ENI which has multiple private and public IPs",
  "Parameters":{
  "Subnet": {
      "Description": "ID of the Subnet the instance should be launched in, this will link the instance to the same VPC.",
      "Type": "List<AWS::EC2::Subnet::Id>"

    }
},
  "Resources": {
    "EIP1": {
      "Type": "AWS::EC2::EIP",
      "Properties": {
        "Tags": [
          {
            "Key": "yor_trace",
            "Value": "611a529b-80c3-43a5-b896-cd45713faf5f"
          },
          {
            "Key": "yor_name",
            "Value": "EIP1"
          }
        ],
        "Domain": "VPC"
      }
    },
    "EIP2": {
      "Type": "AWS::EC2::EIP",
      "Properties": {
        "Tags": [
          {
            "Key": "yor_trace",
            "Value": "79874690-180f-41f4-81d7-649d534d41f2"
          },
          {
            "Key": "yor_name",
            "Value": "EIP2"
          }
        ],
        "Domain": "VPC"
      }
    },
    "Association1":
    {
   "Type": "AWS::EC2::EIPAssociation",
   "DependsOn" : ["ENI","EIP1"],
   "Properties": {
      "AllocationId": { "Fn::GetAtt" : [ "EIP1", "AllocationId" ]},
      "NetworkInterfaceId": {"Ref":"ENI"},
      "PrivateIpAddress": {"Fn::Select" : [ "0", {"Fn::GetAtt" : [ "ENI" , "SecondaryPrivateIpAddresses"]} ]}
   }
},
"Association2":
    {
   "Type": "AWS::EC2::EIPAssociation",
   "DependsOn" : ["ENI","EIP2"],
   "Properties": {
      "AllocationId": { "Fn::GetAtt" : [ "EIP2", "AllocationId" ]},
       "NetworkInterfaceId": {"Ref":"ENI"},
      "PrivateIpAddress": {"Fn::Select" : [ "1", {"Fn::GetAtt" : [ "ENI" , "SecondaryPrivateIpAddresses"]} ]}
   }
},
 "ENI":
{
   "Type" : "AWS::EC2::NetworkInterface",
   "Properties" : {
      "Tags": [
        {
          "Key": "yor_trace",
          "Value": "55444885-34d6-4c58-99d2-6e680031b398"
        },
        {
          "Key": "yor_name",
          "Value": "ENI"
        }
      ],
      "SecondaryPrivateIpAddressCount" : 2,
      "SourceDestCheck" : true,
      "SubnetId" : { "Fn::Select" : [ "0", {"Ref" : "Subnet"} ] }
}



}}}
